# 7.2 CNN可视化

- 卷积神经网络（CNN）是深度学习中非常重要的模型结构，它广泛地用于图像处理，极大地提升了模型表现，推动了计算机视觉的发展和进步。
- 但CNN是一个“黑盒模型”，人们并不知道CNN是如何获得较好表现的，由此带来了深度学习的可解释性问题。如果能理解CNN工作的方式，人们不仅能够解释所获得的结果，提升模型的鲁棒性，而且还能有针对性地改进CNN的结构以获得进一步的效果提升。

- 理解CNN的重要一步是可视化，包括可视化特征是如何提取的、提取到的特征的形式以及模型在输入数据上的关注点等。本节我们就从上述三个方面出发，介绍如何在PyTorch的框架下完成CNN模型的可视化。

## 7.2.1 可视化卷积核

```python
# -*- coding: utf-8 -*—
# Date: 2022/3/21 0021
# Time: 20:23
# Author: HQR

import torch
from torchvision.models import vgg11
import matplotlib.pyplot as plt
plt.rcParams.update({'figure.max_open_warning': 0})

model = vgg11(pretrained=True)
print(dict(model.features.named_children()))

conv1 = dict(model.features.named_children())['3']
kernel_set = conv1.weight.detach()
num = len(conv1.weight.detach())
print('kernel shape is: ', kernel_set.shape)
for i in range(0, num):
    i_kernel = kernel_set[i]
    plt.figure(figsize=(20, 17))
    if (len(i_kernel)) > 1:
        for idx, filer in enumerate(i_kernel):
            plt.subplot(8, 8, idx+1)
            # plt.axis('off')
            plt.imshow(filer[:, :].detach(), cmap='bwr')
        plt.show()
```

![7.2_result](./figure/7.2_result.png)
